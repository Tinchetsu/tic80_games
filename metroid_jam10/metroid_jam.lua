-- title:  Platformer
-- author: @tinchetsu
-- desc:   WIP metroidvania jam game
-- script: lua

--240x136

cam={x=0,y=0}
PI,PI4,cos,sin=math.pi,math.pi/4,math.cos,math.sin
--player shoot dirs
SD={x=cos(PI4),y=sin(PI4)}
--player states
JMP=1
WLK=2
SHT=4

paused=false

function lerp(a,b,t)
	return a*(1-t)+b*t
end


function collide(x1,y1,w1,h1,x2,y2,w2,h2)
	return x1<x2+w2 and x2<x1+w1 and y1<y2+h2 and y2<y1+h1
end

function newEntityManager()
	local E={}
	function E:update()
		for i=#self,1,-1 do
			local e=self[i]
			e:update();
			-- remove dead elements
			if not e.alive then
				self[i]=self[#self]
				self[#self] = nil
			end
		end
	end
	
	function E:draw()
		for _,e in ipairs(self) do
			e:draw()
		end	
	end
	return E
end

SHOOTS=newEntityManager()
ITEMS=newEntityManager()
PARTICLES=newEntityManager()


function bin(n)
    local t = {}
    for i = 1, 32 do
		table.insert(t, 1,n&1)
		n=n>>1
    end
    return table.concat(t)
end

function camera(x,y)
	cam._x=x-120 cam._y=y
	if cam._x <0then cam._x=0 end
	cam.x=math.floor(cam._x)
	cam.y=math.floor(cam._y)
end

function isSolid(x,y)
	return fget(mget(x/8,y/8),0)
end

function moveInMap(e)
	-- move and check x
	e.x=e.x+e.dx
	if e.dx>0then
		if isSolid(e.x+e.w,e.y)or isSolid(e.x+e.w,e.y+e.h)then
			e.x=((e.x+e.w)//8)*8-e.w-1
			e.dx=0
		end
	elseif e.dx<0then
		if isSolid(e.x,e.y)or isSolid(e.x,e.y+e.h)then
			e.x=((e.x//8))*8+8
		end
	end
	-- move and check y
	e.y=e.y+e.dy
	if e.dy>0then
		if isSolid(e.x,e.y+e.h) or isSolid(e.x+e.w,e.y+e.h)then
			e.y=((e.y+e.h)//8)*8-e.h-1
			e.dy=0
		end
	elseif e.dy<0then
		if isSolid(e.x,e.y) or isSolid(e.x+e.w,e.y)then
			e.y=((e.y//8))*8+e.h+1
			e.dy=0
		end
	end
end

function explosion(x,y,size)
	local e={x=x,y=y,s=size,t=8,alive=true}
	function e:update()
		local s=self
		s.t=s.t-1
		s.alive=s.t>=0
	end
	function e:draw()
		local s=self
		local x,y=s.x-cam.x,s.y-cam.y
		circ(x,y,1+s.t*s.s/8,6)
		circ(x,y,s.t*s.s/8,14)
	end
	table.insert(SHOOTS,e)
end

function pShoot(x,y,sx,sy,dir,type)
	local sht={x=x,y=y,dir=dir,type=type,sp=1.5,t=30,alive=true}
	function sht:update()
		local s=self
		s.x=s.x+sx*s.sp
		s.y=s.y+sy*s.sp
		s.t=s.t-1
		if isSolid(s.x+3,s.y+5) then
			s.alive=false
			explosion(s.x+4,s.y+5,3)
			return
		end
		s.alive=s.t>0
	end
	function sht:draw()
		local s=self
		spr(276,s.x-cam.x,s.y-cam.y,0,1,dir)
	end
	if type==1 then
		table.insert(SHOOTS,sht)
	end
end

function makeItem(type,x,y)
	local i={x=x,y=y,w=8,h=8,t=0,ox=0,oy=0,alive=true,del=false}
	function i:update()
		local s=self
		if s.delete then
			s.alive=false
			return
		end
		if collide(pl.x,pl.y,pl.w,pl.h,s.x,s.y,s.w,s.w) then
			Msg:print({{"You got",true},{"Magic Wand",false},{"",true},{"Now you can cast fireballs",true}},112,50)
			s.delete=true
		end
		s.t=s.t+1
		s.oy=2*sin(s.t*0.04)
	end
	
	function i:draw()
		local s=self
		--bubble
		spr(288,s.ox+s.x-cam.x,s.oy+s.y-cam.y+8,0,1,0)
		spr(288,s.ox+s.x-cam.x,s.oy+s.y-cam.y-8,0,1,2)
		spr(288,s.ox+s.x-cam.x-8,s.oy+s.y-cam.y,0,1,0,1)
		spr(288,s.ox+s.x-cam.x+8,s.oy+s.y-cam.y,0,1,1,1)
		
		--item
		spr(289,s.ox+s.x-cam.x,s.oy+s.y-cam.y,0)
	end
	table.insert(ITEMS,i)
end


function Player(x,y)
	local player={
		x=x,y=y,w=3,h=7,dx=0,dy=0,sp=0.6,yinc=0.08,jmp=1.8,s=372,t=0,dir=0,
		st=0, -- 0:ground, 1:jump
		a=1,
		v=0, --shoot y dir, 1:up 0:mid -1:down
		an={256,257,258,257},
		sht=0 --shoot time
	}

	function player:update()
		local p=self
		-- handle inputs
		p.dx=0
		p.v=0
		p.v=btn(0) and 1 or (btn(1) and -1 or 0)
		if btn(2) and not btn(3)then
			p.dx=-p.sp p.dir=1
		end
		if btn(3) and not btn(2)then
			p.dx=p.sp p.dir=0
		end

		p.dy=p.dy+p.yinc
		if p.dy>4 then p.dy=4 end

		moveInMap(p)
		--check state
		if isSolid(p.x,p.y+p.h+1)or isSolid(p.x+p.w,p.y+p.h+1)then
			p.st=p.st&~JMP
		else
			p.st=p.st|JMP
		end
		--jump
		if btn(5) and p.st&JMP~=JMP then
			p.st=p.st|JMP
			p.dy=-p.jmp
		end
		--shoot
		p.sht=p.sht>0 and p.sht-1 or 0
		if btn(4) then
			if p.sht==0 then
				p.sht=15
				local sx,sy,px=SD.x,0
				if p.v==1 then
					sy=-SD.y
				elseif p.v==-1 then
					sy=SD.y
				else
					sx=1
				end
				if p.dir==0 then
					px=p.x+1
				else
					sx=-sx
					px=p.x-4
				end
				pShoot(px,p.y,sx,sy,p.dir,1)
			end
		end
		if p.sht<=0 then
			p.st=p.st&~SHT
		else
			p.st=p.st|SHT
		end
		--animations
		if p.st&JMP~=JMP then
			if p.dx~=0 then
				if p.t%6==0 then
					p.a=p.a<4 and p.a+1 or 1
				end
				p.s=p.an[p.a]
				p.t=p.t+1
			else
				p.s=p.an[2]
			end
		else
			p.s=259
			p.t=0
		end

		camera(p.x,0)
	end
	function player:draw()
		local p=self
		local x,y,s=p.x-cam.x,p.y-cam.y,p.s
		spr(260,x-2,y-8,0,1,p.dir)
		if p.st&SHT==SHT then 
			spr(s+16,x-2,y,0,1,p.dir)
			--wand
			wx=p.dir==0 and x+5 or x-2
			wy=p.v==1 and y+4 or(p.v==-1 and y+6 or y+5)
			pix(wx,wy,9)
		else
			spr(s,x-2,y,0,1,p.dir)
		end
		--draw bbox points
		--pix(p.x-cam.x,p.y-cam.y,12)
		--pix(p.x+p.w-cam.x,p.y-cam.y,12)
		--pix(p.x+p.w-cam.x,p.y+p.h-cam.y,12)
		--pix(p.x-cam.x,p.y+p.h-cam.y,12)
	end
	return player
end

--BG Box
function Box(x,y,w,h)
	local B={x=x,y=y,w=w,h=h}
	function B:update(x,y,w,h)
		local s=self
		s.x,s.y,s.w,s.h=x,y,w,h
	end
	
	function B:draw()
		local s=self
		local tl,br={x=s.x,y=s.y},{x=s.x+s.w*8+8,y=s.y+s.h*8+8}
		--top
		spr(509,tl.x,tl.y,0)
		for i=1,s.w do
			spr(510,tl.x+i*8,tl.y,0)
			--bg
			for j=1,s.h do
				spr(511,tl.x+i*8,tl.y+j*8,0)
			end
		end
		--bottom
		spr(509,tl.x,br.y,0,1,2)
		for i=1,s.w do
			spr(510,tl.x+i*8,br.y,0,1,2)
		end
		spr(509,br.x,br.y,0,1,0,2)
		
		--sidebars
		for i=1,s.h do
			spr(510,tl.x,tl.y+i*8,0,1,0,3)
			spr(510,br.x,tl.y+i*8,0,1,0,1)
		end
	end
	return B
end

--message box
Msg={x,y,tx,t=0,st=0,box}

function Msg:print(tx,x,y)
	local s=self
	s.tx=tx
	s.t=0
	s.st=1
	s.w=0
	s.h=0
	for i,v in ipairs(tx) do
		s.w=math.max(s.w,print(v[1],-100,-100,15,false,1,v[2]))
		s.h=s.h+1
	end
	s.h=s.h+1
	s.w=math.ceil((s.w+8)/8)
	s.w=s.w+1
	s.x=x-(s.w*8//2)
	s.y=y-(s.h*8//2)
	s.box=Box(math.floor(s.x+s.w*8/2),math.floor(s.y+s.h*8/2),0,0)
end

function Msg:update()
	local s=self
	if s.st==1 then
		s.t=s.t+0.1
		if s.t<1 then
			s.box.x=8*lerp(s.x+8*s.w/2,s.x,s.t)//8
			s.box.y=8*lerp(s.y+8*s.h/2,s.y,s.t)//8
			s.box.w=(8*lerp(1,s.w,s.t))//8
			s.box.h=(8*lerp(1,s.h,s.t))//8
			paused=true
		else
			s.box.x=s.x
			s.box.y=s.y
			s.box.w=s.w
			s.box.h=s.h
			s.st=2
			s.t=250
		end
	elseif s.st==2 then
		s.t=s.t-1
		if s.t<=0 then
			s.st=0
			paused=false
		end
	end
end

function Msg:draw()
	local s=self
	if s.st==1 then
		s.box:draw()
	end
	if s.st==2 then
		s.box:draw()
		for i,v in ipairs(s.tx) do
			print(v[1],s.x+8+8,s.y+6+i*8,15,false,1,v[2])
		end
	end
end


pl=Player(186,96)


local test = {}
function test:update()
	trace("update")
end
--Msg:print({"You got","Magic Wand!"},112,50)
makeItem(1,17,115)
--makeItem(1,135,120)
function TIC()	
	
	if not paused then
		pl:update()
		SHOOTS:update()
		ITEMS:update()	
	end
	Msg:update()
	
	
	cls(0)
	rect(0,0,240,32,2)
	circ(50,20,10,15)
	--bg
	map(30,17,61,6,-cam.x*0.5,-cam.y,0)
	map(cam.x//8,cam.y//8,31,18,8*(cam.x//8)-cam.x,8*(cam.y//8)-cam.y,0)
	SHOOTS:draw()
	ITEMS:draw()
	pl:draw()
	Msg:draw()

	--print(pl.x,0,0)
	--print(pl.y,0,6)
	--print("testing text", 0,6,15,false,1,true);
	--print("testing text", 0,12,15,true,1,true);
	--print("testing text", 0,18,15,false,1,false);
	--print("testing text", 0,24,15,true,1,false);
	--print(bin(pl.st),0,10,12)
	--print(pl.sht,0,20,12)
	--print(pl.s,0,30,12)
	--print("cam["..cam.x.." "..cam.y.."]",0,0)
end

-- <TILES>
-- 001:0555555555bbbbbb5bb444445b4444945b4444445b4494445b4444445b444494
-- 002:55555555bbbbbbbb444444444444449449449444444444944494444444449444
-- 003:55555550bbbbbb5544444bb5494944b5444444b5444494b5449444b5444444b5
-- 004:0555555555bbbbbb5bb444445b4944445b4444945bb4944455bbbbbb05555555
-- 005:55555555bbbbbbbb44944444444444944494944494444494bbbbbbbb55555555
-- 006:55555550bbbbbb5544444bb5494494b5444444b594494bb5bbbbbb5555555550
-- 007:0555555055bbbb555bb44bb55b4444b55b4444b55b4944b55b4444b55b4449b5
-- 008:5b4444b55b4444b55b4494b55b4444b55b4944b55b4444b55b4494b55b9444b5
-- 009:5b4449b55b9444b55b4444b55b4944b55b4444b55bb49bb555bbbb5505555550
-- 010:0555555055bbbb555bb44bb55b4944b55b4444b55bb49bb555bbbb5505555550
-- 016:0000006000000666000006e60000006000004000000400000040000004000000
-- 017:5b4444445b4494445b4444945b4444445b4494445b4444445b9444945b444444
-- 018:4444444444444944449444949444444444494444494444944444444444449444
-- 019:444444b5944444b5444494b5494444b5444444b5444444b5449444b5444494b5
-- 020:00000000000000000000000000000000000550000005b500005bb65005b6bbb5
-- 021:000000000000000000000000000000000065500005bb6560056bbb505bbbbbb5
-- 022:000000000000000000055000005b650005bbbb50056bb6500055550000055000
-- 033:5b4444445b4944495b4444445b4449445b4444445bb4449455bbbbbb05555555
-- 034:444944444444494449444444444444444449449444444444bbbbbbbb55555555
-- 035:444494b5444444b5449444b5444444b5449444b594444bb5bbbbbb5555555550
-- 036:005555000505055050505f555505f0f550505f55550505050550505000555500
-- 037:0000000000000000000000000000000000000000000000000077777003737373
-- 098:000000000000000000000005000000550000055b000005bf00005bb500005b5b
-- 099:0000000055505550bbb5bb55b5bbbbbbfb5bbfbb6fbbf6f5fbbbbf5bb55b5bbb
-- 100:00000000000000005000000055000000b55000005f550000f6f500005fb50000
-- 101:2222222222222222222222222222222222222222222222222002222000002200
-- 102:2222222222222222222222222222222222222222222222220222222200222222
-- 103:2222222222222222222222222222222222222222222222222002222000002200
-- 104:2222222222222222222222222222222222222222222222220222222200222222
-- 105:2222222222222222222222222222222222222222222222222222222222222222
-- 106:2222222222222222222222222222222222222222222222222222222222222222
-- 107:2222222222222222222222222222222222222222222222222002222000002200
-- 108:2222222222222222222222222222222222222222222222220222222200222222
-- 114:0005bbbb0005b5fb0005bf6f00055bf5000055bb000005550000000500000000
-- 115:bfb5555ff6fbbbf6bfbb55bfbb5b5bbb5bb5bbbbb5bbb5bb5bbbbbb555444455
-- 116:bb5b5000fbb550005bb50000bb550000b5500000550000005000000000000000
-- 118:0022220000022200000020000000000000000000000000000000000000000000
-- 120:0000222000000200000000000000000000000000000000000000000000000000
-- 121:0022222200222222000222200000220000000000000000000000000000000000
-- 122:2222220000222200000020000000000000000000000000000000000000000000
-- 124:0022220000022200000020000000000000000000000000000000000000000000
-- 131:0494994004994990049449400494994009499940049944900494994004994940
-- </TILES>

-- <TILES1>
-- 001:0666666666555555655333336533332365333333653323336533333365333323
-- 002:6666666655555555333333333333332332332333333333233323333333332333
-- 003:6666666055555566333335563232335633333356333323563323335633333356
-- 004:0666666666555555655333336532333365333323655323336655555506666666
-- 005:6666666655555555332333333333332333232333233333235555555566666666
-- 006:6666666055555566333335563233235633333356233235565555556666666660
-- 007:0666666066555566655335566533335665333356653233566533335665333256
-- 008:6533335665333356653323566533335665323356653333566533235665233356
-- 009:6533325665233356653333566532335665333356655325566655556606666660
-- 010:0666666066555566655335566532335665333356655325566655556606666660
-- 017:6533333365332333653333236533333365332333653333336523332365333333
-- 018:3333333333333233332333232333333333323333323333233333333333332333
-- 019:3333335623333356333323563233335633333356333333563323335633332356
-- 020:0000000000000000000000000000000000066000000656000065526006525556
-- 021:0000000000000000000000000000000000266000065526200625556065555556
-- 022:0000000000000000000660000065260006555560062552600066660000066000
-- 033:6533333365323332653333336533323365333333655333236655555506666666
-- 034:3332333333333233323333333333333333323323333333335555555566666666
-- 035:3333235633333356332333563333335633233356233335565555556666666660
-- </TILES1>

-- <TILES2>
-- 001:0666666666555555655333336533332365333333653323336533333365333323
-- 002:6666666655555555333333333333332332332333333333233323333333332333
-- 003:6666666055555566333335563232335633333356333323563323335633333356
-- 004:0666666666555555655333336532333365333323655323336655555506666666
-- 005:6666666655555555332333333333332333232333233333235555555566666666
-- 006:6666666055555566333335563233235633333356233235565555556666666660
-- 007:0666666066555566655335566533335665333356653233566533335665333256
-- 008:6533335665333356653323566533335665323356653333566533235665233356
-- 009:6533325665233356653333566532335665333356655325566655556606666660
-- 010:0666666066555566655335566532335665333356655325566655556606666660
-- 017:6533333365332333653333236533333365332333653333336523332365333333
-- 018:3333333333333233332333232333333333323333323333233333333333332333
-- 019:3333335623333356333323563233335633333356333333563323335633332356
-- 020:0000000000000000000000000000000000066000000656000065526006525556
-- 021:0000000000000000000000000000000000266000065526200625556065555556
-- 022:0000000000000000000660000065260006555560062552600066660000066000
-- 033:6533333365323332653333336533323365333333655333236655555506666666
-- 034:3332333333333233323333333333333333323323333333335555555566666666
-- 035:3333235633333356332333563333335633233356233335565555556666666660
-- </TILES2>

-- <TILES3>
-- 001:0555555555bbbbbb5bb444445b4444945b4444445b4494445b4444445b444494
-- 002:55555555bbbbbbbb444444444444449449449444444444944494444444449444
-- 003:55555550bbbbbb5544444bb5494944b5444444b5444494b5449444b5444444b5
-- 004:0555555555bbbbbb5bb444445b4344445b4444345bb4344455bbbbbb05555555
-- 005:55555555bbbbbbbb44344444444444344434344434444434bbbbbbbb55555555
-- 006:55555550bbbbbb5544444bb5434434b5444444b534434bb5bbbbbb5555555550
-- 007:0555555055bbbb555bb44bb55b4444b55b4444b55b4344b55b4444b55b4443b5
-- 008:5b4444b55b4444b55b4434b55b4444b55b4344b55b4444b55b4434b55b3444b5
-- 009:6544435665344456654444566543445665444456655435566655556606666660
-- 010:0666666066555566655445566543445665444456655435566655556606666660
-- 017:5b4444445b4494445b4444945b4444445b4494445b4444445b9444945b444444
-- 018:4444444444444944449444949444444444494444494444944444444444449444
-- 019:444444b5944444b5444494b5494444b5444444b5444444b5449444b5444494b5
-- 020:0000000000000000000000000000000000066000000656000065526006525556
-- 021:0000000000000000000000000000000000266000065526200625556065555556
-- 022:0000000000000000000660000065260006555560062552600066660000066000
-- 033:5b4444445b4944495b4444445b4449445b4444445bb4449455bbbbbb05555555
-- 034:444944444444494449444444444444444449449444444444bbbbbbbb55555555
-- 035:444494b5444444b5449444b5444444b5449444b594444bb5bbbbbb5555555550
-- </TILES3>

-- <SPRITES>
-- 000:00949000066666606bbbbb00bbc2c2000bcccc00006696000c6666c000900900
-- 001:00949000066666606bbbbb00bbc2c2000bcccc000066960006c66c0000099000
-- 002:00949000066666606bbbbb00bbc2c2000bcccc0000669600066c660000900900
-- 003:00949000066666606bbbbb00bbc2c2000bcccc00006696000c6666c000909000
-- 004:0000000000000000000000000000000000000000000000000060000000660000
-- 016:00949000066666606bbbbb00bbc2c2000bcccc00006696c00c66660000900900
-- 017:00949000066666606bbbbb00bbc2c2000bcccc00006696c006c6660000099000
-- 018:00949000066666606bbbbb00bbc2c2000bcccc00006696c0066c660000900900
-- 019:00949000066666606bbbbb00bbc2c2000bcccc00006696c00c66660000909000
-- 020:0000000000000000000000000000000000060000006e60000006000000000000
-- 032:d000000d0dddddd0000000000000000000000000000000000000000000000000
-- 033:0000006000000666000006e60000006000004000000400000040000004000000
-- 239:0101010110101010010101011010101001010101101010100101010110101010
-- 253:0000000000000000000000000000000000000000000000000000000200000022
-- 254:00000000000000000000000000000000000000000000000022222222ffffffff
-- 255:1111111111111111111111111111111111111111111111111111111111111111
-- </SPRITES>

-- <SPRITES1>
-- 000:003e3000022222202666660066c8c80006cccc000022e2000c2222c000300300
-- 001:003e3000022222202666660066c8c80006cccc000022e20002c22c0000033000
-- 002:003e3000022222202666660066c8c80006cccc000022e200022c220000300300
-- 003:003e3000022222202666660066c8c80006cccc000022e2000c2222c000303000
-- 004:0000000000000000000000000000000000000000000000000020000000220000
-- 016:003e3000022222202666660066c8c80006cccc000022e2c40c22220000300300
-- 017:003e3000022222202666660066c8c80006cccc000022e2c402c2220000033000
-- 018:003e3000022222202666660066c8c80006cccc000022e2c4022c220000300300
-- 019:003e3000022222202666660066c8c80006cccc000022e2c40c22220000303000
-- </SPRITES1>

-- <SPRITES2>
-- 000:00343000022222202666660066c8c80006cccc00002242000c2222c000300300
-- 001:00343000022222202666660066c8c80006cccc000022420002c22c0000033000
-- 002:00343000022222202666660066c8c80006cccc0000224200022c220000300300
-- 003:00343000022222202666660066c8c80006cccc00002242000c2222c000303000
-- 004:0000000000000000000000000000000000000000000000000020000000220000
-- 016:00343000022222202666660066c8c80006cccc00002242c30c22220000300300
-- 017:00343000022222202666660066c8c80006cccc00002242c302c2220000033000
-- 018:00343000022222202666660066c8c80006cccc00002242c3022c220000300300
-- 019:00343000022222202666660066c8c80006cccc00002242c30c22220000303000
-- </SPRITES2>

-- <MAP>
-- 000:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 001:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 002:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 003:700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 004:800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 005:800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 006:800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 007:800000000000000000000000102030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 008:800000000000000000000000112131005500000000000000000000000000006100000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 009:800000000000000000000000112131405060000000000000000000000000102030004050505050505060000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 010:800000000000000000000000112131000000000000000000000000000000112131000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 011:800000000000000000000000112131000000405060000000000000a00000122232000000000000000000102030405060405060102030002636460000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 012:800000000000006100410000112131000000000000000000410000000000000000000000000000000000112131000000000000112131002737470000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 013:8000000000000040506000001222320000000000000040505060002636460000000000a000a000263646122232000000000000122232002838482636460000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 014:800000000000a00000000000424242000000000000000000000000273747000000000000000000273747000000000000000000000000002838482737470000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 015:9000520000a00000510000004242420000610000004100000000a0283848006100005100005100283848000000000000000000000000002838482838480000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 016:102020202030202020202020202020202020202020202020203040505060405050505050505050505050505050505050505050505050505050505050505050505050505060900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 020:700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 021:8000000000000000000000000000000000000000000000000000000000005666768696a6b6c65666768696a6b6c65666768696a6b6c65666768696a6b6c65666768696a6b6c65666768696a6b6c6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 022:8000000000000000000000000000000000000000000000000000000000005767778797a7b7c75767778797a7b7c75767778797a7b7c75767778797a7b7c75767778797a7b7c75767778797a7b7c7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 023:800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 024:800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 025:800000000000000000000000000000005500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 026:800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 027:800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 028:800000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 029:800000000000006100410000006100000000000000000000410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 030:800000000000004050600000405060000000000000004050506000263646000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 031:800000000000000000000100000000000000000000000000000000273747000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 032:900000005100700000000051000000610000000000410000000000283848000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 033:102020202030202020202020202020202020202020202020203040505060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </MAP>

-- <WAVES>
-- 000:00000000ffffffff00000000ffffffff
-- 001:0123456789abcdeffedcba9876543210
-- 002:0123456789abcdef0123456789abcdef
-- </WAVES>

-- <SFX>
-- 000:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000304000000000
-- </SFX>

-- <FLAGS>
-- 000:00101010101010101010100000000000001010100000000000000000000000000010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </FLAGS>

-- <PALETTE>
-- 000:0000007e25531d2b535f574fab5236008751ff004d83769cff77a8ffa300c2c3c700e756ffccaa29adfffff024fff1e8
-- </PALETTE>

-- <PALETTE1>
-- 000:0000007e2553ff004dffa300ab523600e75604875183769c1d2b535f574fc2c3c7ff77a8ffccaa29adfffff024ffffff
-- </PALETTE1>

-- <PALETTE2>
-- 000:1010145d275dff3e53ef7d57ffcd75a7f07038b76425717929366f3b5dc941a6f673eff7f4f4f494b0c2566c86333c57
-- </PALETTE2>

-- <PALETTE3>
-- 000:0000007e25531d2b535f574fab5236008751ff004d83769cff77a8ffa300c2c3c700e756ffccaa29adfffff024fff1e8
-- </PALETTE3>

